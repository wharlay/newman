name: api-test
on:
  push:
    branches: [ main, master ]
  pull_request:
    branches: [ main, master ]
  schedule:
    - cron: '0 0 * * *' # Runs daily at 12 midnight
    
jobs:
  api-test:
    runs-on: ubuntu-latest
    steps:
        
    # Install the newman command line utility and also install the html extra reporter
      - name: Install newman report
        run: npm install -g newman-reporter-html

      - uses: actions/checkout@main
      - uses: wharlay/newman@main
        with:
          apiKey: PMAK-6687fe113eddb60001032243-153a97dc1e429d72e464b13c4af211792c
          collection: 36687321-d9ce477a-7d69-4130-901a-e19c44f3ab29
          reporters: '["html,cli"]'
  
    # Make directory to upload the test results
      - name: Make Directory for results
        run: mkdir -p testResults
          

      # Upload the contents of Test Results directory to workspace
      - name: Output the run Details
        uses: actions/upload-artifact@v2
        with:
          name: RunReports
          path: testResults
